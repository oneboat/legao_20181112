<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zxq.legao.dao.ContractDao">
    <insert id="insertContract" parameterType="com.zxq.legao.entity.po.ContractPO">
        INSERT INTO legao_contract(
            legao_contract.contractCode,
            legao_contract.studentId,
            legao_contract.signDate,
            legao_contract.classPackageId,
            legao_contract.price,
            legao_contract.discount,
            legao_contract.depositId,
            legao_contract.act_pay,
            legao_contract.payType,
            legao_contract.presentationClassTime,
            legao_contract.startTime,
            legao_contract.endTime,
            legao_contract.belongOne,
            legao_contract.memberCarId,
            legao_contract.remark
        ) VALUES(#{contractCode},#{studentId},#{signDate},#{classPackageId},#{price},#{discount},#{depositId},#{actPay},
                 #{payType},#{presentationClassTime},#{startTime},#{endTime},#{belongOne},#{memberCarId},#{remark}
        );
    </insert>
    <delete id="deleteContract" parameterType="java.util.List">
        DELETE FROM legao_contract WHERE id IN
        <foreach collection="list" separator="," close=")" open="(" item="id">
            #{id}
        </foreach>

    </delete>
    <update id="updateContract" parameterType="com.zxq.legao.entity.po.ContractPO">
        UPDATE legao_contract SET
                                  contractCode = #{contractCode},studentId = #{studentId},signDate = #{signDate},classPackageId = #{classPackageId},
                                  price = #{price},discount = #{discount},depositId = #{depositId},act_pay = #{actPay},
                                  payType = #{payType},presentationClassTime = #{presentationClassTime},startTime = #{startTime},endTime = #{endTime},
                                  belongOne = #{belongOne},memberCarId = #{memberCarId},remark = #{remark}
        WHERE id = #{id};
    </update>
    <select id="selectContract"
            resultType="com.zxq.legao.entity.vo.ContractVO" statementType="STATEMENT" resultMap="select_contractMap">

        SELECT
        id,
        <foreach collection="fields" separator="," item="fields">${fields}</foreach>

        FROM
        legao_contract

        <where>

            <if test="contractPO.contractCode!=null and contractPO.contractCode!=''">
                and contractCode like '%${contractPO.contractCode}%'
            </if>
            <if test="contractPO.studentId!=null and contractPO.studentId!=''">
                and studentId = ${contractPO.studentId}
            </if>
        </where>
    </select>
    <select id="selectContractByID" parameterType="java.lang.Integer" resultType="com.zxq.legao.entity.vo.ContractVO" resultMap="select_contractMap">
        SELECT
            legao_contract.id,
            legao_contract.contractCode,
            legao_contract.studentId,
            legao_contract.signDate,
            legao_contract.classPackageId,
            legao_contract.price,
            legao_contract.discount,
            legao_contract.depositId,
            legao_contract.act_pay,
            legao_contract.payType,
            legao_contract.presentationClassTime,
            legao_contract.startTime,
            legao_contract.endTime,
            legao_contract.belongOne,
            legao_contract.memberCarId,
            legao_contract.remark
        FROM
            legao_contract
        WHERE id = #{id};
    </select>
    <resultMap id="select_contractMap" type="com.zxq.legao.entity.vo.ContractVO">
        <id column="id" property="id"></id>
        <result column="contractCode" property="contractCode"></result>
        <result column="signDate" property="signDate"></result>
        <result column="price" property="price"></result>
        <result column="discount" property="discount"></result>
        <result column="act_pay" property="actPay"></result>
        <result column="payType" property="payType"></result>
        <result column="presentationClassTime" property="presentationClassTime"></result>
        <result column="startTime" property="startTime"></result>
        <result column="endTime" property="endTime"></result>
        <result column="belongOne" property="belongOne"></result>
        <result column="remark" property="remark"></result>
        <result column="memberCarId" property="memberCarId"></result>
        <result column="depositId" property="depositId"></result>
        <association property="studentVO" column="studentId"
                     select="com.zxq.legao.dao.StudentDao.selectStudentByID"
                     javaType="com.zxq.legao.entity.vo.StudentVO"></association>
        <association property="classtimepackVO" column="classPackageId"
                     select="com.zxq.legao.dao.ClasstimepackDao.selectClasstimepackByID"
                     javaType="com.zxq.legao.entity.po.ClasstimepackPO"></association>
        <association property="membercardVO" column="memberCarId"
                     select="com.zxq.legao.dao.MembercardDao.selectMembercardByID"
                     javaType="com.zxq.legao.entity.po.MembercardPO"></association>
        <association property="depositVO" column="depositId" javaType="com.zxq.legao.entity.po.DepositPO"
                     select="com.zxq.legao.dao.DepositDao.selectDepositByID"></association>

    </resultMap>
<select id="selectContractByStudentId" parameterType="java.lang.Integer" resultType="com.zxq.legao.entity.vo.ContractVO" resultMap="select_contractMap">
    SELECT
        legao_contract.id,
        legao_contract.contractCode,
        legao_contract.studentId,
        legao_contract.signDate,
        legao_contract.classPackageId,
        legao_contract.price,
        legao_contract.discount,
        legao_contract.depositId,
        legao_contract.act_pay,
        legao_contract.payType,
        legao_contract.presentationClassTime,
        legao_contract.startTime,
        legao_contract.endTime,
        legao_contract.belongOne,
        legao_contract.memberCarId,
        legao_contract.remark
    FROM
        legao_contract
    WHERE studentId = #{studentId};
</select>
</mapper>
