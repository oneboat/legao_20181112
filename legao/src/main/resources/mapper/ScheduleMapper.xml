<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zxq.legao.dao.ScheduleDao">
    <insert id="insertSchedule" parameterType="com.zxq.legao.entity.po.SchedulePO">
        INSERT INTO legao_schedule(legao_schedule.schoolAreaID,
                                  legao_schedule.`dateID`,
                                  legao_schedule.courseID,
                                  legao_schedule.classroomID,
                                  legao_schedule.courseDate,
                                   legao_schedule.teacherName,
                                   legao_schedule.courseWeek,
                                   legao_schedule.weekOfYear
        )
        VALUES (#{schoolAreaID},
                #{dateID},
                #{courseID},
                #{classroomID},
                #{courseDate},
                #{teacherName},
                #{courseWeek},
                #{weekOfYear});
    </insert>
    <delete id="deleteSchedule" parameterType="java.lang.Integer">
        DELETE FROM legao_schedule WHERE id = #{id};

    </delete>
    <update id="updateSchedule" parameterType="com.zxq.legao.entity.po.SchedulePO">
        UPDATE legao_schedule
        SET
            schoolAreaID = #{schoolAreaID},
            dateID       = #{dateID},
            courseID  = #{courseID},
            classroomID  = #{classroomID},
            courseDate  = #{courseDate},
            teacherName = #{teacherName},
            courseWeek = #{courseWeek},
            weekOfYear = #{weekOfYear}
        WHERE id = #{id};
    </update>
    <select id="selectSchedule"
            resultType="com.zxq.legao.entity.vo.ScheduleVO" resultMap="select_scheduleMap">

        SELECT
        legao_schedule.id,
        legao_schedule.schoolAreaID,
        legao_schedule.dateID,
        legao_schedule.courseID,
        legao_schedule.classroomID,
        legao_schedule.courseDate,
        legao_schedule.teacherName,
        legao_schedule.courseWeek,
        legao_schedule.weekOfYear
        FROM
        legao_schedule


        <where>
            <if test="weekOfYear == null">
                and  YEARWEEK(courseDate) = YEARWEEK(now())
                and schoolAreaID = 1
            </if>
            <if test="weekOfYear != null and weekOfYear !=''">
                and  weekOfYear = #{weekOfYear}
                and schoolAreaID = 1
            </if>

            <if test="courseID!=null and courseID!=''">
                and courseID = #{courseID}
            </if>
            <if test="classroomID!=null and classroomID!=''">
                and classroomID = #{classroomID}
            </if>
            <if test="teacherName!=null and teacherName!=''">
                and teacherName = #{teacherName}
            </if>
            <if test="schoolAreaID!=null and schoolAreaID!=''">
                and schoolAreaID = #{schoolAreaID}
            </if>
            <if test="courseDate!=null and courseDate!=''">
                and courseDate = #{courseDate}
            </if>
            <if test="weekOfYear!=null and weekOfYear!=''">
                and weekOfYear = #{weekOfYear}
            </if>

        </where>


    </select>
    <select id="selectScheduleByID" parameterType="java.lang.Integer" resultType="com.zxq.legao.entity.vo.ScheduleVO"
            resultMap="select_scheduleMap">
        SELECT
            legao_schedule.id,
            legao_schedule.schoolAreaID,
            legao_schedule.dateID,
            legao_schedule.courseID,
            legao_schedule.classroomID,
            legao_schedule.courseDate,
            legao_schedule.teacherName,
            legao_schedule.courseWeek,
            legao_schedule.weekOfYear
        FROM
            legao_schedule

        WHERE id = #{id}
    </select>
    <resultMap id="select_scheduleMap" type="com.zxq.legao.entity.vo.ScheduleVO">
        <id column="id" property="id"></id>
        <result column="teacherName" property="teacherName"></result>
        <result column="courseWeek" property="courseWeek"></result>
        <association property="date" column="dateID"
                     select="com.zxq.legao.dao.DateDao.selectDateByID"
                     javaType="com.zxq.legao.entity.po.DatePO"></association>
        <association property="schoolArea" column="schoolAreaID"
                     select="com.zxq.legao.dao.SchoolAreaDao.selectSchoolAreaByID"
                     javaType="com.zxq.legao.entity.vo.SchoolAreaVO"></association>
        <association property="course" column="courseID" javaType="com.zxq.legao.entity.vo.CourseVO"
                     select="com.zxq.legao.dao.CourseDao.selectCourseByID"></association>
        <association property="classroom" column="classroomID" javaType="com.zxq.legao.entity.vo.ClassRoomVO"
                     select="com.zxq.legao.dao.ClassRoomDao.selectClassRoomByID"></association>
    </resultMap>

</mapper>
